<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Checkout Demo</title>
    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        max-width: 800px;
        margin: 2rem auto;
        padding: 1rem;
      }
      .product, #cart {
        border: 1px solid #ddd;
        border-radius: 6px;
        padding: 1rem;
        margin-bottom: 1rem;
      }
      .product-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      button {
        padding: 0.4rem 0.8rem;
        border-radius: 4px;
        border: 1px solid #444;
        background: #f5f5f5;
        cursor: pointer;
      }
      button:hover {
        background: #e8e8e8;
      }
      #payment_message {
        margin-top: 0.8rem;
        padding: 0.5rem 0.8rem;
        border-radius: 4px;
        background: #e6ffe6;
        border: 1px solid #7acc7a;
      }
      #error_message {
        margin-top: 0.8rem;
        padding: 0.5rem 0.8rem;
        border-radius: 4px;
        background: #ffe6e6;
        border: 1px solid #cc7a7a;
      }
      .totals {
        margin-top: 0.8rem;
      }
      label {
        display: block;
        margin-top: 0.5rem;
      }
      input[type="text"] {
        padding: 0.3rem;
        width: 200px;
      }
    </style>
  </head>
  <body>
    <h1>Checkout</h1>

    <div class="product" id="product_1">
      <div class="product-header">
        <div>
          <strong class="product_name" id="product_name_1">Plain T-Shirt</strong><br />
          <span>Size M</span>
        </div>
        <div>
          <span class="price" id="price_1">20.00</span> USD
          <button id="add_item_1">Add to cart</button>
        </div>
      </div>
    </div>

    <div id="cart">
      <h2>Your Cart</h2>
      <div id="cart_items">No items yet.</div>

      <div class="totals">
        <p>Subtotal: <span id="subtotal_price">0.00</span> USD</p>

        <label for="discount_code">Discount code:</label>
        <input type="text" id="discount_code" name="discount_code" />
        <button id="apply_coupon">Apply</button>

        <p>Discount applied: <span id="discount_amount">0.00</span> USD</p>
        <p><strong>Total:</strong> <span id="total_price">0.00</span> USD</p>
      </div>

      <button id="pay_now">Pay Now</button>
      <div id="payment_message" style="display:none">Payment successful!</div>
      <div id="error_message" style="display:none">Payment failed. Please try again.</div>
    </div>

    <script>
      const PRICE = 20.0;
      let quantity = 0;
      let discount = 0.0;

      const cartItemsEl = document.getElementById("cart_items");
      const subtotalEl = document.getElementById("subtotal_price");
      const discountEl = document.getElementById("discount_amount");
      const totalEl = document.getElementById("total_price");
      const paymentMsg = document.getElementById("payment_message");
      const errorMsg = document.getElementById("error_message");

      function updateTotals() {
        const subtotal = PRICE * quantity;
        const total = Math.max(subtotal - discount, 0);
        subtotalEl.textContent = subtotal.toFixed(2);
        discountEl.textContent = discount.toFixed(2);
        totalEl.textContent = total.toFixed(2);
      }

      document.getElementById("add_item_1").addEventListener("click", function () {
        quantity += 1;
        cartItemsEl.textContent = quantity > 0
          ? `Plain T-Shirt x ${quantity}`
          : "No items yet.";
        updateTotals();
      });

      document.getElementById("apply_coupon").addEventListener("click", function () {
        const code = document.getElementById("discount_code").value.trim().toUpperCase();
        const subtotal = PRICE * quantity;

        // simple demo rules:
        // SAVE10 => 10% off
        // SAVE5  => flat 5 off
        if (!quantity) {
          discount = 0.0;
        } else if (code === "SAVE10") {
          discount = subtotal * 0.10;
        } else if (code === "SAVE5") {
          discount = 5.0;
        } else {
          discount = 0.0;
        }
        updateTotals();
      });

      document.getElementById("pay_now").addEventListener("click", function () {
        paymentMsg.style.display = "none";
        errorMsg.style.display = "none";

        const total = parseFloat(totalEl.textContent || "0");
        if (total <= 0 || quantity === 0) {
          errorMsg.textContent = "Cannot pay: cart is empty or total is zero.";
          errorMsg.style.display = "block";
        } else {
          paymentMsg.textContent = "Payment successful!";
          paymentMsg.style.display = "block";
        }
      });
    </script>
  </body>
</html>
